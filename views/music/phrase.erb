\version "2.24.1"

\language "english"

#(set-global-staff-size <%= scale %>)

<%
    if @staves[:upper][:clef] == 'bass'
        fixed = "c"
    else
        fixed = "c'"
    end
%>

upper = \fixed <%= fixed %> {
    \key <%= key %>
    \time <%= time %>
    \clef <%= @staves[:upper][:clef] %>

    \override Score.TimeSignature.stencil = ##f

    \override Score.BarLine.stencil = ##f
    \override Score.BarLine.break-visibility = ##(#f #f #f)

    <%= @staves[:upper][:notes] %>
}

<% if @staves.key? :lower %>
    <%
        if @staves[:lower][:clef] == 'bass'
            fixed = "c"
        else
            fixed = "c'"
        end
    %>

    lower = \fixed c {
        \key <%= key %>
        \time <%= time %>
        \clef <%= @staves[:lower][:clef] %>

        \override Score.TimeSignature.stencil = ##f

        \override Score.BarLine.stencil = ##f
        \override Score.BarLine.break-visibility = ##(#f #f #f)

        <%= @staves[:lower][:notes] %>
    }
<% end %>

<% if @staves.key? :lower %>
    \new PianoStaff
    <<
        \new Staff = "upper" \upper
        \new Staff = "lower" \lower
    >>
<% else %>
    \new Staff = "upper" \upper
<% end %>